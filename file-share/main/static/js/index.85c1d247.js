(function(){"use strict";var e={1012:function(e,t,l){var n=l(7425),i=l(4668),s=(l(6420),l(8407)),a=l(4779);const o={class:"body"},r={class:"container"},u={class:"card-header"},d={style:{width:"max-content"}},c={style:{width:"max-content"}},f={class:"card-header"},p=(0,s.Lk)("div",null,"分享列表",-1),m={class:"upload-box"},g=(0,s.Lk)("i",{class:"el-icon-upload"},null,-1),F=(0,s.Lk)("div",{class:"el-upload__text"},[(0,s.eW)(" 拖拽"),(0,s.Lk)("b",null,"文件"),(0,s.eW)("或"),(0,s.Lk)("b",null,"文件夹"),(0,s.eW)("到此处或点击"),(0,s.Lk)("em",null,"选择文件"),(0,s.eW)("，进行分享~ ")],-1),b={class:"username"},h={key:1},k={class:"btn-box"},v=(0,s.Fv)('<div class="start-btn-shadow"><span style="--i:1;"></span><span style="--i:2;"></span><span style="--i:3;"></span><span style="--i:4;"></span><span style="--i:5;"></span><span style="--i:6;"></span><span style="--i:7;"></span><span style="--i:8;"></span><span style="--i:9;"></span><span style="--i:10;"></span></div>',1);function y(e,t,l,n,i,y){const _=(0,s.g2)("Setting"),I=(0,s.g2)("el-icon"),w=(0,s.g2)("el-button"),C=(0,s.g2)("el-switch"),V=(0,s.g2)("el-form-item"),S=(0,s.g2)("el-input"),x=(0,s.g2)("el-form"),N=(0,s.g2)("el-col"),L=(0,s.g2)("el-row"),W=(0,s.g2)("el-dialog"),T=(0,s.g2)("Link"),U=(0,s.g2)("qrcode-vue"),E=(0,s.g2)("el-popover"),O=(0,s.g2)("Sort"),j=(0,s.g2)("el-tooltip"),D=(0,s.g2)("el-card"),X=(0,s.g2)("Message"),P=(0,s.g2)("Delete"),Q=(0,s.g2)("el-popconfirm"),A=(0,s.g2)("el-upload"),$=(0,s.g2)("DocumentCopy"),z=(0,s.g2)("FolderOpened"),q=(0,s.g2)("el-alert"),R=(0,s.g2)("el-space");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("div",r,[(0,s.bF)(w,{class:"setting-btn",onClick:t[0]||(t[0]=e=>y.onHandlerSetting()),type:"default",title:"设置"},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(_)])),_:1}),(0,s.eW)(" 设置 ")])),_:1}),(0,s.bF)(W,{modelValue:e.settingFormVisible,"onUpdate:modelValue":t[7]||(t[7]=t=>e.settingFormVisible=t),title:"设置",style:{width:"70%"}},{footer:(0,s.k6)((()=>[(0,s.bF)(w,{type:"primary",onClick:y.updateSettingsForm},{default:(0,s.k6)((()=>[(0,s.eW)("更新")])),_:1},8,["onClick"]),(0,s.bF)(w,{type:"primary",onClick:y.closeSettingsForm},{default:(0,s.k6)((()=>[(0,s.eW)("取消")])),_:1},8,["onClick"])])),default:(0,s.k6)((()=>[(0,s.bF)(L,{class:"row-bg"},{default:(0,s.k6)((()=>[(0,s.bF)(N,{span:24},{default:(0,s.k6)((()=>[(0,s.bF)(x,{ref:"form",model:e.settingForm,"label-width":"80px"},{default:(0,s.k6)((()=>[(0,s.bF)(V,{label:"服务自启"},{default:(0,s.k6)((()=>[(0,s.bF)(C,{modelValue:e.settingForm.autoStart,"onUpdate:modelValue":t[1]||(t[1]=t=>e.settingForm.autoStart=t)},null,8,["modelValue"])])),_:1}),(0,s.bF)(V,{label:"上传路径"},{default:(0,s.k6)((()=>[(0,s.bF)(S,{modelValue:e.settingForm.uploadPath,"onUpdate:modelValue":t[2]||(t[2]=t=>e.settingForm.uploadPath=t)},null,8,["modelValue"])])),_:1}),(0,s.bF)(V,{label:"服务端口"},{default:(0,s.k6)((()=>[(0,s.bF)(S,{modelValue:e.settingForm.port,"onUpdate:modelValue":t[3]||(t[3]=t=>e.settingForm.port=t)},null,8,["modelValue"])])),_:1}),(0,s.bF)(V,{label:"密码认证"},{default:(0,s.k6)((()=>[(0,s.bF)(C,{modelValue:e.settingForm.authEnable,"onUpdate:modelValue":t[4]||(t[4]=t=>e.settingForm.authEnable=t)},null,8,["modelValue"])])),_:1}),e.settingForm.authEnable?((0,s.uX)(),(0,s.Wv)(V,{key:0,label:"校验密码"},{default:(0,s.k6)((()=>[(0,s.bF)(S,{modelValue:e.settingForm.password,"onUpdate:modelValue":t[5]||(t[5]=t=>e.settingForm.password=t),"show-password":""},null,8,["modelValue"])])),_:1})):(0,s.Q3)("",!0),(0,s.bF)(V,{label:"调试工具"},{default:(0,s.k6)((()=>[(0,s.bF)(C,{modelValue:e.devTool,"onUpdate:modelValue":t[6]||(t[6]=t=>e.devTool=t),onChange:y.switchDevTool},null,8,["modelValue","onChange"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,s.Lk)("div",{style:(0,a.Tr)("start"===e.serverStatus?"":"display:none")},[(0,s.bF)(R,{size:"large",direction:"vertical"},{default:(0,s.k6)((()=>[(0,s.bF)(D,{class:"box-card"},{header:(0,s.k6)((()=>[(0,s.Lk)("div",u,[(0,s.bF)(L,{class:"row-bg",justify:"space-between"},{default:(0,s.k6)((()=>[(0,s.bF)(N,{span:6},{default:(0,s.k6)((()=>[(0,s.eW)("正在分享...")])),_:1}),(0,s.bF)(w,{type:"danger",onClick:y.stopServer,plain:""},{default:(0,s.k6)((()=>[(0,s.eW)("取消分享")])),_:1},8,["onClick"])])),_:1})])])),default:(0,s.k6)((()=>[(0,s.bF)(L,{class:"row-bg",justify:"space-between"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",d,"分享链接："+(0,a.v_)(e.settingForm.url),1),(0,s.Lk)("div",c,[(0,s.bF)(L,{justify:"end"},{default:(0,s.k6)((()=>[(0,s.bF)(E,{placement:"left",width:125,trigger:"hover"},{reference:(0,s.k6)((()=>[(0,s.bF)(w,{type:"default",title:"复制链接到剪切板",onClick:t[8]||(t[8]=t=>y.handleClipboard(e.settingForm.url,t))},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(T)])),_:1}),(0,s.eW)("  复制 ")])),_:1})])),default:(0,s.k6)((()=>[(0,s.bF)(U,{value:e.settingForm.url},null,8,["value"])])),_:1}),(0,s.bF)(j,{effect:"dark",content:"切换ip协议",placement:"top-start"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{type:"default",title:"切换ip协议",onClick:t[9]||(t[9]=e=>y.changeIpFamily())},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(O)])),_:1}),(0,s.eW)("  "+(0,a.v_)(e.ipFamily),1)])),_:1})])),_:1}),(0,s.bF)(j,{effect:"dark",content:"切换网卡",placement:"top-start"},{default:(0,s.k6)((()=>[e.netInterfaceNames.length>1?((0,s.uX)(),(0,s.Wv)(w,{key:0,type:"default",title:"切换网卡",onClick:t[10]||(t[10]=e=>y.changeNetInterface())},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(O)])),_:1}),(0,s.eW)("  "+(0,a.v_)(e.currentInterfaceName),1)])),_:1})):(0,s.Q3)("",!0)])),_:1})])),_:1})])])),_:1})])),_:1}),(0,s.bF)(D,{class:"box-card"},{header:(0,s.k6)((()=>[(0,s.bF)(W,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[12]||(t[12]=t=>e.dialogFormVisible=t),title:"分享一段文本"},{footer:(0,s.k6)((()=>[(0,s.bF)(w,{type:"primary",onClick:y.formSubmit},{default:(0,s.k6)((()=>[(0,s.eW)("提交")])),_:1},8,["onClick"])])),default:(0,s.k6)((()=>[(0,s.bF)(S,{type:"textarea",rows:2,autosize:{minRows:2,maxRows:4},placeholder:"请输入内容",modelValue:e.form.text,"onUpdate:modelValue":t[11]||(t[11]=t=>e.form.text=t)},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,s.Lk)("div",f,[(0,s.bF)(L,{class:"row-bg",justify:"space-between"},{default:(0,s.k6)((()=>[p,(0,s.Lk)("div",null,[(0,s.bF)(L,{justify:"end"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{onClick:t[13]||(t[13]=t=>e.dialogFormVisible=!0),type:"default",title:"分享一段文本"},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(X)])),_:1}),(0,s.eW)("  分享文本 ")])),_:1}),(0,s.bF)(Q,{onConfirm:t[14]||(t[14]=e=>y.removeFileAll()),title:"确定要清空所有文件吗？"},{reference:(0,s.k6)((()=>[(0,s.bF)(w,{type:"default",title:"清空列表"},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(P)])),_:1}),(0,s.eW)("  清空列表 ")])),_:1})])),_:1})])),_:1})])])),_:1})])])),default:(0,s.k6)((()=>[(0,s.Lk)("div",m,[(0,s.bF)(A,{ref:"uploadFile",accept:"",drag:"",multiple:"","show-file-list":!1,action:"","http-request":y.addFiles},{default:(0,s.k6)((()=>[g,F])),_:1},8,["http-request"])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.files,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"text item file-item"},[(0,s.bF)(L,{class:"row-bg",justify:"space-between"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.bF)(j,{effect:"light",placement:"top"},{content:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(`由【${e.username}】分享`),1)])),default:(0,s.k6)((()=>[(0,s.Lk)("span",b,"【"+(0,a.v_)(e.username)+"】：",1)])),_:2},1024),"text"===e.type?((0,s.uX)(),(0,s.Wv)(j,{key:0,effect:"light",placement:"top"},{content:(0,s.k6)((()=>[(0,s.eW)((0,a.v_)(e.intro),1)])),default:(0,s.k6)((()=>[(0,s.Lk)("span",null,(0,a.v_)(e.name),1)])),_:2},1024)):["directory","file"].includes(e.type)?((0,s.uX)(),(0,s.CE)("span",h,(0,a.v_)(e.name),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",null,[(0,s.bF)(E,{placement:"left",width:125,trigger:"hover"},{reference:(0,s.k6)((()=>[(0,s.bF)(w,{style:(0,a.Tr)(["directory","file"].includes(e.type)?"":"visibility:hidden;"),type:"default",size:"small",title:"复制链接到剪切板",onClick:t=>y.handleFileUrlCopy(e,t)},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(T)])),_:1})])),_:2},1032,["style","onClick"])])),default:(0,s.k6)((()=>[(0,s.bF)(U,{value:y.getFileUrl(e)},null,8,["value"])])),_:2},1024),["text"].includes(e.type)?((0,s.uX)(),(0,s.Wv)(w,{key:0,type:"default",size:"small",title:"复制文本到剪切板",onClick:t=>y.handleClipboard(e.content,t)},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)($)])),_:1})])),_:2},1032,["onClick"])):(0,s.Q3)("",!0),["directory","file"].includes(e.type)?((0,s.uX)(),(0,s.Wv)(w,{key:1,type:"default",size:"small",title:"打开文件所在目录",onClick:t=>y.openFile(e.name,t)},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(z)])),_:1})])),_:2},1032,["onClick"])):(0,s.Q3)("",!0),(0,s.bF)(w,{type:"default",size:"small",onClick:()=>y.removeFile(e)},{default:(0,s.k6)((()=>[(0,s.bF)(I,null,{default:(0,s.k6)((()=>[(0,s.bF)(P)])),_:1})])),_:2},1032,["onClick"])])])),_:2},1024)])))),128)),0===e.files.length?((0,s.uX)(),(0,s.Wv)(q,{key:0,title:"无",closable:!1,type:"info",center:""})):(0,s.Q3)("",!0)])),_:1})])),_:1})],4),(0,s.Lk)("div",{style:(0,a.Tr)("start"===e.serverStatus?"display:none":"")},[(0,s.Lk)("div",k,[(0,s.Lk)("div",{class:"start-btn",onClick:t[15]||(t[15]=(...e)=>y.startServer&&y.startServer(...e))},"开启服务"),v])],4)])])}var _=l(4177),I=l.n(_),w=l(3193),C=l(8439),V=l(1018);let S=window.api,x=(e,t)=>{const l=new(I())(t.target,{text:()=>e});l.on("success",(()=>{console.log("copy success",e),w.nk.success({message:"复制链接成功",type:"success"})})),l.onClick(t),l.destroy()};var N={name:"App",components:{QrcodeVue:C.A,Setting:V.B5R,Link:V.N_E,Sort:V.FUI,Message:V.QBZ,Delete:V.epd,DocumentCopy:V.f5b,FolderOpened:V.KE6},data:()=>({serverStatus:"stop",qrcode:"",files:[],ipFamily:"ipv4",netInterfaceNames:[],currentNetInterfaceIdx:0,currentInterfaceName:"",form:{text:""},settingFormVisible:!1,settingForm:{autoStart:!1,url:"",uploadPath:"",port:5421},devTool:!1,dialogFormVisible:!1,timer:null}),methods:{onHandlerSetting:function(){console.log("--onHandlerSetting--"),this.settingForm=S.getSetting(),this.settingFormVisible=!0},updateSettingsForm:function(){console.log(this.settingForm),S.updateSetting(this.settingForm).then((()=>{w.nk.success("更新成功"),this.settingForm=S.getSetting(),this.settingFormVisible=!1})).catch((()=>{w.nk.error("更新失败"),this.settingForm=S.getSetting(),this.settingFormVisible=!1}))},closeSettingsForm:function(){this.settingForm=S.getSetting(),this.settingFormVisible=!1},formSubmit:function(){let e=this.form.text;S.addText(e,this.settingForm.ip),this.files=S.listFiles(),this.form.text="",this.dialogFormVisible=!1},startServer:function(){this.settingForm=S.getSetting(),S.startServer()},stopServer:function(){S.stopServer()},addFiles:function(e){console.log("addFiles",e);let t={name:e.file.name,path:window.api.getPathForFile(e.file),username:this.settingForm.ip},{success:l,message:n}=S.addFile(t);l?this.files=S.listFiles():w.nk.error(n)},removeFileAll:function(){this.files.forEach((e=>{S.removeFile(e)})),this.files=S.listFiles(),w.nk.success({message:"已清空列表",type:"success"})},removeFile:function(e){let t=this.files.filter((t=>t.name===e.name));console.log(t),S.removeFile(t[0]),this.files=S.listFiles()},openFile:function(e){S.openFile(e,(e=>{w.nk.error({message:`文件打开失败 "${e}"`,type:"error"})}))},handleFileUrlCopy:function(e,t){let l=this.getFileUrl(e);x(l,t)},getFileUrl(e){let t=this.settingForm.url+`/api/download?filename=${encodeURIComponent(e.name)}&token=${S.getSystemToken()}&timestamp=${(new Date).getTime()}`;return t},handleClipboard:function(e,t){x(e,t)},changeIpFamily:function(){this.ipFamily="ipv4"===this.ipFamily?"ipv6":"ipv4",this.currentNetInterfaceIdx=0,this.netInterfaceNames=S.getNetInterfaceNames(this.ipFamily),this.currentInterfaceName=this.netInterfaceNames[0]||"",this.updateIp()},changeNetInterface:function(){99===this.currentNetInterfaceIdx?this.currentNetInterfaceIdx=0:this.currentNetInterfaceIdx=this.currentNetInterfaceIdx+1,this.currentInterfaceName=this.netInterfaceNames[this.currentNetInterfaceIdx%this.netInterfaceNames.length],this.updateIp()},updateIp(){let e=S.getIpAddress(this.currentNetInterfaceIdx,this.ipFamily);"ipv6"===this.ipFamily&&(e=`[${e}]`),S.updateIp(e).then((()=>{this.settingForm=S.getSetting(),w.nk.success({message:`切换网卡为 "${this.currentInterfaceName}"`,type:"success"})}))},updatePage(){this.serverStatus=S.getServerStatus(),this.netInterfaceNames=S.getNetInterfaceNames(this.ipFamily),this.currentInterfaceName=this.netInterfaceNames[0]||"",this.files=S.listFiles(),this.settingForm=S.getSetting(),console.log("---settingForm--",this.settingForm)},switchDevTool(){console.log("---switchDevTool--",this.devTool),this.devTool?S.openDevTool():S.closeDevTool()}},mounted:function(){console.log(S),S.registryEventListener("server.statusChange",(e=>{console.log("---服务状态变更---",e),this.serverStatus=e.data.status})),S.registryEventListener("fileDb.listChange",(e=>{console.log("---文件列表变更---",e),this.files=S.listFiles(),console.log(this.files)})),this.updatePage()},beforeUnmount(){clearInterval(this.timer),this.timer=null}},L=l(2615);const W=(0,L.A)(N,[["render",y]]);var T=W;const U=(0,n.Ef)(T);U.use(i.A),U.mount("#app")}},t={};function l(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,l),s.exports}l.m=e,function(){var e=[];l.O=function(t,n,i,s){if(!n){var a=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],s=e[d][2];for(var o=!0,r=0;r<n.length;r++)(!1&s||a>=s)&&Object.keys(l.O).every((function(e){return l.O[e](n[r])}))?n.splice(r--,1):(o=!1,s<a&&(a=s));if(o){e.splice(d--,1);var u=i();void 0!==u&&(t=u)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,i,s]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={57:0};l.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,s,a=n[0],o=n[1],r=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(i in o)l.o(o,i)&&(l.m[i]=o[i]);if(r)var d=r(l)}for(t&&t(n);u<a.length;u++)s=a[u],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(d)},n=self["webpackChunkfile_share_app"]=self["webpackChunkfile_share_app"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=l.O(void 0,[504],(function(){return l(1012)}));n=l.O(n)})();